library(data.table)
thres=95
context="fb"
df.lst = list();i=0; for (thres in c(95,99,999)) {
for (context in c("fb","heart")) {
i = i + 1
f = paste0("/Users/amarderstein/Library/Mobile Documents/com~apple~CloudDocs/Documents/Research/chrombpnet_variant_effects/output/ldsc/results/extended3/joint-annot/Schizophrenia_PGCWave3_2022.FLARE_",context,".thres",thres,".results")
df = fread(f, data.table = F, stringsAsFactors = F)
df$thres = thres
df$context = context
df.lst[[i]] = df
}
}
df.all = as.data.frame(do.call(rbind,df.lst))
library(ggplot2)
library(dplyr)
df.all2 = subset(df.all, Category == "L2_1")
df.all2 <- df.all2 %>%
mutate(
thres = factor(thres, levels = c("95","99","999")),
lower_CI = Enrichment - 1.96 * Enrichment_std_error,
upper_CI = Enrichment + 1.96 * Enrichment_std_error,
context = recode(context, "fb" = "Fetal brain", "heart" = "Heart")
)
# optional bound
df.all2$lower_CI[df.all2$lower_CI < -1] = -1
g=ggplot(df.all2, aes(x = thres, y = Enrichment, color = context, group = context)) +
geom_line() +
geom_point() +
geom_ribbon(aes(ymin = lower_CI, ymax = upper_CI, fill = context),
alpha = 0.2, color = NA) +
# scale_y_log10() +
scale_x_discrete(labels = c("95" = "Top 5%", "99" = "Top 1%", "999" = "Top 0.1%")) +
scale_fill_manual(values = c("Fetal brain" = "#E0CA70", "Heart" = "#B30606")) +
scale_color_manual(values = c("Fetal brain" = "#E0CA70", "Heart" = "#B30606")) +
labs(x = "FLARE Threshold", y = "Enrichment of per-SNP\nheritability (schizophrenia)",col="Context",fill="Context") +
theme_bw() +
geom_hline(yintercept = 0, col = 'red', lty = 'dashed') +
geom_hline(yintercept = 13.6, col = 'orange', lty = 'dashed') +
ggpubr::theme_pubr();g
