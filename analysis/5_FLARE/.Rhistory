"Fetal brain neurons" = "#E0CA70",
"Adult brain" = "#483FA3",
"Fetal brain non-neurons" = "#4D3B3B",
"Fetal heart" = "#B30606",
"Adult heart" = "#A34D3F",
"Fetal heart" = "#852222"
)) +
scale_fill_manual(values = c(
"Fetal brain neurons" = "#E0CA70",
"Adult brain" = "#483FA3",
"Fetal brain non-neurons" = "#4D3B3B",
"Fetal heart" = "#B30606",
"Adult heart" = "#A34D3F",
"Fetal heart" = "#852222"
)) +
scale_shape_manual(
values = c(
"base" = 19,
"peak" = 19,
"cbp" = 15,
"int" = 17
),
labels=c("Base","Peaks","ChromBPNet","ChromBPNet x Peak")
) +
theme_minimal() +
# ggpubr::theme_pubr() +
theme(
axis.text.y = element_blank(),  # <- hides feature names
axis.ticks.y = element_blank(),
panel.grid.major.y = element_blank(),
axis.text.x = element_text(angle = 45, hjust = 1),
strip.text = element_text(face = "bold"),
plot.title = element_text(hjust=0.5)
# panel.grid = element_blank(),
) +
labs(x = "Model", y = NULL, color = "Context",shape="Feature Set",
title = "Non-Zero FLARE Coefficents") +
guides(fill="none")
pdf("/Users/amarderstein/Library/Mobile Documents/com~apple~CloudDocs/Documents/Research/chrombpnet_variant_effects/output/flare/flare_lasso_weights.pdf",width = 5,height=8)
print(g)
dev.off()
g=ggplot(df_long, aes(x = model_clean, y = feature)) +
# Background grey dot for FALSE or NA
# geom_point(data = subset(df_long, status != TRUE),
#            aes(color = context_v2,fill = context_v2), shape = 21, size = 3, stroke = 0.2) +
# Colored dot for TRUE
geom_point(data = subset(df_long, status == TRUE),
# aes(color = context_v2,fill = context_v2), shape = 21, size = 3, stroke = 0.2) +
aes(color = context_v2,fill = context_v2,shape=type), size = 3, stroke = 0.2) +
# facet_wrap(~type, ncol = 1,) +
scale_color_manual(values = c(
"Fetal brain neurons" = "#E0CA70",
"Adult brain" = "#483FA3",
"Fetal brain non-neurons" = "#4D3B3B",
"Fetal heart" = "#B30606",
"Adult heart" = "#A34D3F",
"Fetal heart" = "#852222"
)) +
scale_fill_manual(values = c(
"Fetal brain neurons" = "#E0CA70",
"Adult brain" = "#483FA3",
"Fetal brain non-neurons" = "#4D3B3B",
"Fetal heart" = "#B30606",
"Adult heart" = "#A34D3F",
"Fetal heart" = "#852222"
)) +
scale_shape_manual(
values = c(
"base" = 19,
"peak" = 19,
"cbp" = 15,
"int" = 17
),
labels=c("Base","Peaks","ChromBPNet","ChromBPNet x Peak")
) +
# theme_minimal() +
theme_bw() +
# ggpubr::theme_pubr() +
theme(
axis.text.y = element_blank(),  # <- hides feature names
axis.ticks.y = element_blank(),
panel.grid.major.y = element_blank(),
axis.text.x = element_text(angle = 45, hjust = 1),
strip.text = element_text(face = "bold"),
plot.title = element_text(hjust=0.5)
# panel.grid = element_blank(),
) +
labs(x = "Model", y = NULL, color = "Context",shape="Feature Set",
title = "Non-Zero FLARE Coefficents") +
guides(fill="none")
pdf("/Users/amarderstein/Library/Mobile Documents/com~apple~CloudDocs/Documents/Research/chrombpnet_variant_effects/output/flare/flare_lasso_weights.pdf",width = 5,height=8)
print(g)
dev.off()
g=ggplot(df_long, aes(x = model_clean, y = feature)) +
# Background grey dot for FALSE or NA
geom_point(data = subset(df_long, status != TRUE),
color='white',fill='white', shape = 21, size = 3, stroke = 0.2) +
# Colored dot for TRUE
geom_point(data = subset(df_long, status == TRUE),
# aes(color = context_v2,fill = context_v2), shape = 21, size = 3, stroke = 0.2) +
aes(color = context_v2,fill = context_v2,shape=type), size = 3, stroke = 0.2) +
# facet_wrap(~type, ncol = 1,) +
scale_color_manual(values = c(
"Fetal brain neurons" = "#E0CA70",
"Adult brain" = "#483FA3",
"Fetal brain non-neurons" = "#4D3B3B",
"Fetal heart" = "#B30606",
"Adult heart" = "#A34D3F",
"Fetal heart" = "#852222"
)) +
scale_fill_manual(values = c(
"Fetal brain neurons" = "#E0CA70",
"Adult brain" = "#483FA3",
"Fetal brain non-neurons" = "#4D3B3B",
"Fetal heart" = "#B30606",
"Adult heart" = "#A34D3F",
"Fetal heart" = "#852222"
)) +
scale_shape_manual(
values = c(
"base" = 19,
"peak" = 19,
"cbp" = 15,
"int" = 17
),
labels=c("Base","Peaks","ChromBPNet","ChromBPNet x Peak")
) +
# theme_minimal() +
theme_bw() +
# ggpubr::theme_pubr() +
theme(
axis.text.y = element_blank(),  # <- hides feature names
axis.ticks.y = element_blank(),
panel.grid.major.y = element_blank(),
axis.text.x = element_text(angle = 45, hjust = 1),
strip.text = element_text(face = "bold"),
plot.title = element_text(hjust=0.5)
# panel.grid = element_blank(),
) +
labs(x = "Model", y = NULL, color = "Context",shape="Feature Set",
title = "Non-Zero FLARE Coefficents") +
guides(fill="none")
g
g=ggplot(df_long, aes(x = model_clean, y = feature)) +
# Background grey dot for FALSE or NA
# geom_point(data = subset(df_long, status != TRUE),
#            color='white',fill='white', shape = 21, size = 3, stroke = 0.2) +
# Colored dot for TRUE
geom_point(data = subset(df_long, status == TRUE),
# aes(color = context_v2,fill = context_v2), shape = 21, size = 3, stroke = 0.2) +
aes(color = context_v2,fill = context_v2,shape=type), size = 3, stroke = 0.2) +
# facet_wrap(~type, ncol = 1,) +
scale_color_manual(values = c(
"Fetal brain neurons" = "#E0CA70",
"Adult brain" = "#483FA3",
"Fetal brain non-neurons" = "#4D3B3B",
"Fetal heart" = "#B30606",
"Adult heart" = "#A34D3F",
"Fetal heart" = "#852222"
)) +
scale_fill_manual(values = c(
"Fetal brain neurons" = "#E0CA70",
"Adult brain" = "#483FA3",
"Fetal brain non-neurons" = "#4D3B3B",
"Fetal heart" = "#B30606",
"Adult heart" = "#A34D3F",
"Fetal heart" = "#852222"
)) +
scale_shape_manual(
values = c(
"base" = 19,
"peak" = 19,
"cbp" = 15,
"int" = 17
),
labels=c("Base","Peaks","ChromBPNet","ChromBPNet x Peak")
) +
# theme_minimal() +
theme_bw() +
# ggpubr::theme_pubr() +
theme(
axis.text.y = element_blank(),  # <- hides feature names
axis.ticks.y = element_blank(),
panel.grid.major.y = element_blank(),
axis.text.x = element_text(angle = 45, hjust = 1),
strip.text = element_text(face = "bold"),
plot.title = element_text(hjust=0.5)
# panel.grid = element_blank(),
) +
labs(x = "Model", y = NULL, color = "Context",shape="Feature Set",
title = "Non-Zero FLARE Coefficents") +
guides(fill="none")
g
ggplot(df.melt,aes(x=100*num_cells/30,y=value^2,col=variable)) +
# geom_line() +
geom_point() +
geom_smooth(fill='lightgrey',alpha=0.25) +
scale_color_manual(values=c("FLARE_baseline" = "#66BBBB",
"FLARE_fb_peaks" = "black",
"FLARE_fb" =  "#E0CA70"),
labels=c("FLARE_baseline" = "Baseline",
"FLARE_fb_peaks" = "Fetal brain (peaks)",
"FLARE_fb" =  "Fetal brain")
) +
ggpubr::theme_pubr() +
scale_x_continuous(breaks=c(0,25,50,75)) +
labs(x="Minimum % fb accessible contexts",y=expression("Estimated R"^2),title = "SNP conservation prediction") +
ylim(0,0.05) +
theme(plot.title = element_text(hjust=0.5),  legend.position = c(0.05, 0.95),
legend.justification = c("left", "top"),legend.title = element_blank(),legend.background = element_blank())
ggplot(df.melt,aes(x=100*num_cells/30,y=value,col=variable)) +
# geom_line() +
geom_point() +
geom_smooth(fill='lightgrey',alpha=0.25) +
scale_color_manual(values=c("FLARE_baseline" = "#66BBBB",
"FLARE_fb_peaks" = "black",
"FLARE_fb" =  "#E0CA70"),
labels=c("FLARE_baseline" = "Baseline",
"FLARE_fb_peaks" = "Fetal brain (peaks)",
"FLARE_fb" =  "Fetal brain")
) +
ggpubr::theme_pubr() +
scale_x_continuous(breaks=c(0,25,50,75)) +
labs(x="Minimum % fb accessible contexts",y=expression("PhyloP Corr. (Pred vs Obs)"),title = "SNP conservation prediction") +
# ylim(0,0.05) +
theme(plot.title = element_text(hjust=0.5),  legend.position = c(0.05, 0.95),
legend.justification = c("left", "top"),legend.title = element_blank(),legend.background = element_blank())
library(data.table)
df = fread("/Users/amarderstein/Library/Mobile Documents/com~apple~CloudDocs/Documents/Research/chrombpnet_variant_effects/output/flare/num_peaks_fb.asd.txt",data.table = F,stringsAsFactors = F)
df = df[,-2]
df$R2_ratio = (df[,3]^2) / (df[,2]^2)
df.melt = melt(df,id.vars="num_cells")
f.out = ("/Users/amarderstein/Library/Mobile Documents/com~apple~CloudDocs/Documents/Research/chrombpnet_variant_effects/output/flare/flare_predictive_accuracy.r2.pdf")
pdf(f.out,width = 5,height = 5)
ggplot(df.melt,aes(x=100*num_cells/30,y=value^2,col=variable)) +
# geom_line() +
geom_point() +
geom_smooth(fill='lightgrey',alpha=0.25) +
scale_color_manual(values=c("FLARE_baseline" = "#66BBBB",
"FLARE_fb_peaks" = "black",
"FLARE_fb" =  "#E0CA70"),
labels=c("FLARE_baseline" = "Baseline",
"FLARE_fb_peaks" = "Fetal brain (peaks)",
"FLARE_fb" =  "Fetal brain")
) +
ggpubr::theme_pubr() +
scale_x_continuous(breaks=c(0,25,50,75)) +
labs(x="Minimum % fb accessible contexts",y=expression("Estimated R"^2),title = "SNP conservation prediction") +
ylim(0,0.05) +
theme(plot.title = element_text(hjust=0.5),  legend.position = c(0.05, 0.95),
legend.justification = c("left", "top"),legend.title = element_blank(),legend.background = element_blank())
dev.off()
f.out = ("/Users/amarderstein/Library/Mobile Documents/com~apple~CloudDocs/Documents/Research/chrombpnet_variant_effects/output/flare/flare_predictive_accuracy.r.pdf")
pdf(f.out,width = 5,height = 5)
ggplot(df.melt,aes(x=100*num_cells/30,y=value,col=variable)) +
# geom_line() +
geom_point() +
geom_smooth(fill='lightgrey',alpha=0.25) +
scale_color_manual(values=c("FLARE_baseline" = "#66BBBB",
"FLARE_fb_peaks" = "black",
"FLARE_fb" =  "#E0CA70"),
labels=c("FLARE_baseline" = "Baseline",
"FLARE_fb_peaks" = "Fetal brain (peaks)",
"FLARE_fb" =  "Fetal brain")
) +
ggpubr::theme_pubr() +
scale_x_continuous(breaks=c(0,25,50,75)) +
labs(x="Minimum % fb accessible contexts",y=expression("PhyloP Corr. (Pred vs Obs)"),title = "SNP conservation prediction") +
# ylim(0,0.05) +
theme(plot.title = element_text(hjust=0.5),  legend.position = c(0.05, 0.95),
legend.justification = c("left", "top"),legend.title = element_blank(),legend.background = element_blank())
dev.off()
library(data.table)
df = fread("/Users/amarderstein/Library/Mobile Documents/com~apple~CloudDocs/Documents/Research/chrombpnet_variant_effects/output/flare/num_peaks_fb.asd.txt",data.table = F,stringsAsFactors = F)
df = df[,-2]
df$R2_ratio = (df[,3]^2) / (df[,2]^2)
df.melt = melt(df,id.vars="num_cells")
f.out = ("/Users/amarderstein/Library/Mobile Documents/com~apple~CloudDocs/Documents/Research/chrombpnet_variant_effects/output/flare/flare_predictive_accuracy.r2.pdf")
pdf(f.out,width = 5,height = 5)
ggplot(df.melt,aes(x=100*num_cells/30,y=value^2,col=variable)) +
# geom_line() +
geom_point() +
geom_smooth(fill='lightgrey',alpha=0.25) +
scale_color_manual(values=c("FLARE_baseline" = "#66BBBB",
"FLARE_fb_peaks" = "black",
"FLARE_fb" =  "#E0CA70"),
labels=c("FLARE_baseline" = "Baseline",
"FLARE_fb_peaks" = "Fetal brain (peaks)",
"FLARE_fb" =  "Fetal brain")
) +
ggpubr::theme_pubr() +
scale_x_continuous(breaks=c(0,25,50,75)) +
labs(x="Minimum % fb accessible contexts",y=expression("Estimated R"^2),title = "SNP conservation prediction") +
ylim(0,0.05) +
theme(plot.title = element_text(hjust=0.5),  legend.position = c(0.05, 0.95),
legend.justification = c("left", "top"),legend.title = element_blank(),legend.background = element_blank())
dev.off()
f.out = ("/Users/amarderstein/Library/Mobile Documents/com~apple~CloudDocs/Documents/Research/chrombpnet_variant_effects/output/flare/flare_predictive_accuracy.r.pdf")
pdf(f.out,width = 5,height = 5)
ggplot(df.melt,aes(x=100*num_cells/30,y=value,col=variable)) +
# geom_line() +
geom_point() +
geom_smooth(fill='lightgrey',alpha=0.25) +
scale_color_manual(values=c("FLARE_baseline" = "#66BBBB",
"FLARE_fb_peaks" = "black",
"FLARE_fb" =  "#E0CA70"),
labels=c("FLARE_baseline" = "Baseline",
"FLARE_fb_peaks" = "Fetal brain (peaks)",
"FLARE_fb" =  "Fetal brain")
) +
ggpubr::theme_pubr() +
scale_x_continuous(breaks=c(0,25,50,75)) +
labs(x="Minimum % fb accessible contexts",y=expression("PhyloP Corr. (Pred vs Obs)"),title = "SNP conservation prediction") +
# ylim(0,0.05) +
theme(plot.title = element_text(hjust=0.5),  legend.position = c(0.05, 0.95),
legend.justification = c("left", "top"),legend.title = element_blank(),legend.background = element_blank())
dev.off()
head(df.melt)
ggplot(df.melt,aes(x=100*num_cells/30,y=value,col=variable)) +
# geom_line() +
geom_point() +
geom_smooth(fill='lightgrey',alpha=0.25) +
scale_color_manual(values=c("FLARE_baseline" = "#66BBBB",
"FLARE_fb_peaks" = "black",
"FLARE_fb" =  "#E0CA70"),
labels=c("FLARE_baseline" = "Baseline",
"FLARE_fb_peaks" = "Fetal brain (peaks)",
"FLARE_fb" =  "Fetal brain")
) +
ggpubr::theme_pubr() +
scale_x_continuous(breaks=c(0,25,50,75)) +
labs(x="Minimum % fb accessible contexts",y=expression("PhyloP Corr. (Pred vs Obs)"),title = "SNP conservation prediction") +
# ylim(0,0.05) +
theme(plot.title = element_text(hjust=0.5),  legend.position = c(0.05, 0.95),
legend.justification = c("left", "top"),legend.title = element_blank(),legend.background = element_blank())
library(data.table)
df = fread("/Users/amarderstein/Library/Mobile Documents/com~apple~CloudDocs/Documents/Research/chrombpnet_variant_effects/output/flare/num_peaks_fb.asd.txt",data.table = F,stringsAsFactors = F)
df = df[,-2]
df$R2_ratio = (df[,3]^2) / (df[,2]^2)
df.melt = melt(df,id.vars="num_cells")
head(df)
head(df.melt)
f.out = ("/Users/amarderstein/Library/Mobile Documents/com~apple~CloudDocs/Documents/Research/chrombpnet_variant_effects/output/flare/flare_predictive_accuracy.r2.pdf")
pdf(f.out,width = 5,height = 5)
ggplot(df.melt,aes(x=100*num_cells/30,y=value^2,col=variable)) +
# geom_line() +
geom_point() +
geom_smooth(fill='lightgrey',alpha=0.25) +
scale_color_manual(values=c("FLARE_baseline" = "#66BBBB",
"FLARE_fb_peaks" = "black",
"FLARE_fb" =  "#E0CA70"),
labels=c("FLARE_baseline" = "Baseline",
"FLARE_fb_peaks" = "Fetal brain (peaks)",
"FLARE_fb" =  "Fetal brain")
) +
ggpubr::theme_pubr() +
scale_x_continuous(breaks=c(0,25,50,75)) +
labs(x="Minimum % fb accessible contexts",y=expression("Estimated R"^2),title = "SNP conservation prediction") +
ylim(0,0.05) +
theme(plot.title = element_text(hjust=0.5),  legend.position = c(0.05, 0.95),
legend.justification = c("left", "top"),legend.title = element_blank(),legend.background = element_blank())
dev.off()
ggplot(df.melt,aes(x=100*num_cells/30,y=value^2,col=variable)) +
# geom_line() +
geom_point() +
geom_smooth(fill='lightgrey',alpha=0.25) +
scale_color_manual(values=c("FLARE_baseline" = "#66BBBB",
"FLARE_fb_peaks" = "black",
"FLARE_fb" =  "#E0CA70"),
labels=c("FLARE_baseline" = "Baseline",
"FLARE_fb_peaks" = "Fetal brain (peaks)",
"FLARE_fb" =  "Fetal brain")
) +
ggpubr::theme_pubr() +
scale_x_continuous(breaks=c(0,25,50,75)) +
labs(x="Minimum % fb accessible contexts",y=expression("Estimated R"^2),title = "SNP conservation prediction") +
ylim(0,0.05) +
theme(plot.title = element_text(hjust=0.5),  legend.position = c(0.05, 0.95),
legend.justification = c("left", "top"),legend.title = element_blank(),legend.background = element_blank())
df.melt
library(data.table)
df = fread("/Users/amarderstein/Library/Mobile Documents/com~apple~CloudDocs/Documents/Research/chrombpnet_variant_effects/output/flare/num_peaks_fb.asd.txt",data.table = F,stringsAsFactors = F)
df = df[,-2]
df.melt = melt(df,id.vars="num_cells")
f.out = ("/Users/amarderstein/Library/Mobile Documents/com~apple~CloudDocs/Documents/Research/chrombpnet_variant_effects/output/flare/flare_predictive_accuracy.r2.pdf")
pdf(f.out,width = 5,height = 5)
ggplot(df.melt,aes(x=100*num_cells/30,y=value^2,col=variable)) +
# geom_line() +
geom_point() +
geom_smooth(fill='lightgrey',alpha=0.25) +
scale_color_manual(values=c("FLARE_baseline" = "#66BBBB",
"FLARE_fb_peaks" = "black",
"FLARE_fb" =  "#E0CA70"),
labels=c("FLARE_baseline" = "Baseline",
"FLARE_fb_peaks" = "Fetal brain (peaks)",
"FLARE_fb" =  "Fetal brain")
) +
ggpubr::theme_pubr() +
scale_x_continuous(breaks=c(0,25,50,75)) +
labs(x="Minimum % fb accessible contexts",y=expression("Estimated R"^2),title = "SNP conservation prediction") +
ylim(0,0.05) +
theme(plot.title = element_text(hjust=0.5),  legend.position = c(0.05, 0.95),
legend.justification = c("left", "top"),legend.title = element_blank(),legend.background = element_blank())
dev.off()
f.out = ("/Users/amarderstein/Library/Mobile Documents/com~apple~CloudDocs/Documents/Research/chrombpnet_variant_effects/output/flare/flare_predictive_accuracy.r.pdf")
pdf(f.out,width = 5,height = 5)
ggplot(df.melt,aes(x=100*num_cells/30,y=value,col=variable)) +
# geom_line() +
geom_point() +
geom_smooth(fill='lightgrey',alpha=0.25) +
scale_color_manual(values=c("FLARE_baseline" = "#66BBBB",
"FLARE_fb_peaks" = "black",
"FLARE_fb" =  "#E0CA70"),
labels=c("FLARE_baseline" = "Baseline",
"FLARE_fb_peaks" = "Fetal brain (peaks)",
"FLARE_fb" =  "Fetal brain")
) +
ggpubr::theme_pubr() +
scale_x_continuous(breaks=c(0,25,50,75)) +
labs(x="Minimum % fb accessible contexts",y=expression("PhyloP Corr. (Pred vs Obs)"),title = "SNP conservation prediction") +
# ylim(0,0.05) +
theme(plot.title = element_text(hjust=0.5),  legend.position = c(0.05, 0.95),
legend.justification = c("left", "top"),legend.title = element_blank(),legend.background = element_blank())
dev.off()
df$R2_ratio = (df[,3]^2) / (df[,2]^2)
library(data.table)
df = fread("/Users/amarderstein/Library/Mobile Documents/com~apple~CloudDocs/Documents/Research/chrombpnet_variant_effects/output/flare/num_peaks_fb.asd.txt",data.table = F,stringsAsFactors = F)
df = df[,-2]
df.melt = melt(df,id.vars="num_cells")
df
df.melt
f.out = ("/Users/amarderstein/Library/Mobile Documents/com~apple~CloudDocs/Documents/Research/chrombpnet_variant_effects/output/flare/flare_predictive_accuracy.r2.pdf")
pdf(f.out,width = 5,height = 5)
ggplot(df.melt,aes(x=100*num_cells/30,y=value^2,col=variable)) +
# geom_line() +
geom_point() +
geom_smooth(fill='lightgrey',alpha=0.25) +
scale_color_manual(values=c("FLARE_baseline" = "#66BBBB",
"FLARE_fb_peaks" = "black",
"FLARE_fb" =  "#E0CA70"),
labels=c("FLARE_baseline" = "Baseline",
"FLARE_fb_peaks" = "Fetal brain (peaks)",
"FLARE_fb" =  "Fetal brain")
) +
ggpubr::theme_pubr() +
scale_x_continuous(breaks=c(0,25,50,75)) +
labs(x="Minimum % fb accessible contexts",y=expression("Estimated R"^2),title = "SNP conservation prediction") +
ylim(0,0.05) +
theme(plot.title = element_text(hjust=0.5),  legend.position = c(0.05, 0.95),
legend.justification = c("left", "top"),legend.title = element_blank(),legend.background = element_blank())
dev.off()
f.out = ("/Users/amarderstein/Library/Mobile Documents/com~apple~CloudDocs/Documents/Research/chrombpnet_variant_effects/output/flare/flare_predictive_accuracy.r.pdf")
pdf(f.out,width = 5,height = 5)
ggplot(df.melt,aes(x=100*num_cells/30,y=value,col=variable)) +
# geom_line() +
geom_point() +
geom_smooth(fill='lightgrey',alpha=0.25) +
scale_color_manual(values=c("FLARE_baseline" = "#66BBBB",
"FLARE_fb_peaks" = "black",
"FLARE_fb" =  "#E0CA70"),
labels=c("FLARE_baseline" = "Baseline",
"FLARE_fb_peaks" = "Fetal brain (peaks)",
"FLARE_fb" =  "Fetal brain")
) +
ggpubr::theme_pubr() +
scale_x_continuous(breaks=c(0,25,50,75)) +
labs(x="Minimum % fb accessible contexts",y=expression("PhyloP Corr. (Pred vs Obs)"),title = "SNP conservation prediction") +
# ylim(0,0.05) +
theme(plot.title = element_text(hjust=0.5),  legend.position = c(0.05, 0.95),
legend.justification = c("left", "top"),legend.title = element_blank(),legend.background = element_blank())
dev.off()
ggplot(df.melt,aes(x=100*num_cells/30,y=value,col=variable)) +
# geom_line() +
geom_point() +
geom_smooth(fill='lightgrey',alpha=0.25) +
scale_color_manual(values=c("FLARE_baseline" = "#66BBBB",
"FLARE_fb_peaks" = "black",
"FLARE_fb" =  "#E0CA70"),
labels=c("FLARE_baseline" = "Baseline",
"FLARE_fb_peaks" = "Fetal brain (peaks)",
"FLARE_fb" =  "Fetal brain")
) +
ggpubr::theme_pubr() +
scale_x_continuous(breaks=c(0,25,50,75)) +
labs(x="Minimum % fb accessible contexts",y=expression("PhyloP Corr. (Pred vs Obs)"),title = "SNP conservation prediction") +
# ylim(0,0.05) +
theme(plot.title = element_text(hjust=0.5),  legend.position = c(0.05, 0.95),
legend.justification = c("left", "top"),legend.title = element_blank(),legend.background = element_blank())
library(data.table)
library(ggplot2)
library(dplyr)
breast = fread("~/Downloads/breast/score/breast_pgs.txt.gz",data.table = F,stringsAsFactors = F)
prostate = fread("~/Downloads/prostate/score/prostate_pgs.txt.gz",data.table = F,stringsAsFactors = F)
# breast = fread("~/Downloads/breast_pgs.txt.gz",data.table = F,stringsAsFactors = F)
# prostate = fread("~/Downloads/prostate_pgs.txt.gz",data.table = F,stringsAsFactors = F)
breast = subset(breast,sampleset!="reference")
prostate = subset(prostate,sampleset!="reference")
# pgs_of_interest = "PGS000030_hmPOS_GRCh37"
pgs_of_interest = "PGS000004_hmPOS_GRCh37"
# pgs_of_interest = "PGS000006_hmPOS_GRCh37"
breast = subset(breast,PGS==pgs_of_interest)
prostate = subset(prostate,PGS==pgs_of_interest)
df = as.data.frame(rbind(breast,prostate))
head(breast)
breast$IID
lapply(strsplit(breast$IID[1:5],"-"),function(x) x[1:2])
lapply(strsplit(breast$IID[1:5],"-"),function(x) paste(x[1:2],sep = '-'))
lapply(strsplit(breast$IID[1:5],"-"),function(x) paste(x[1:2],collapse = '-'))
lapply(strsplit(breast$IID,"-"),function(x) paste(x[1:2],collapse = '-'))
fwrite(as.data.frame(lapply(strsplit(breast$IID,"-"),function(x) paste(x[1:2],collapse = '-'))),"~/Downloads/msk_impact_breast_ids_short.txt",quote = F,na = "NA",sep = '\t',row.names = F,col.names = T)
fwrite(as.data.frame(unlist(lapply(strsplit(breast$IID,"-"),function(x) paste(x[1:2],collapse = '-')))),"~/Downloads/msk_impact_breast_ids_short.txt",quote = F,na = "NA",sep = '\t',row.names = F,col.names = T)
fwrite(as.data.frame(unlist(lapply(strsplit(breast$IID,"-"),function(x) paste(x[1:2],collapse = '-')))),"~/Downloads/msk_impact_breast_ids_short.txt",quote = F,na = "NA",sep = '\t',row.names = F,col.names = F)
